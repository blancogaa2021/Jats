; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

#define MyAppName "JASP"
#define MyAppVersion "@JASP_VERSION_MAJOR@.@JASP_VERSION_MINOR@.@JASP_VERSION_PATCH@@JASP_VERSION_MSIX_PATCH_POSTFIX@.@JASP_VERSION_TWEAK@"
#define MyAppPublisher "The JASP Team."
#define MyAppURL "https://jasp-stats.org/"
#define MyAppExeName "JASP.exe"
#define MyAppAssocName MyAppName + " File"
#define MyAppAssocExt ".jasp"
#define MyAppAssocKey StringChange(MyAppAssocName, " ", "") + MyAppAssocExt

#define CsvAssocName "CSV File"
#define CsvAssocExt ".csv"
#define CsvAssocKey StringChange(CsvAssocName, " ", "") + CsvAssocExt

#define OdsAssocName "Open Document Spreadsheet File"
#define OdsAssocExt ".ods"
#define OdsAssocKey StringChange(OdsAssocName, " ", "") + OdsAssocExt

#define XlsAssocName "Excel(97-2003) File"
#define XlsAssocExt ".xls"
#define XlsAssocKey StringChange(XlsAssocName, " ", "") + XlsAssocExt

#define XlsxAssocName "Excel File"
#define XlsxAssocExt ".xlsx"
#define XlsxAssocKey StringChange(XlsxAssocName, " ", "") + XlsxAssocExt

#define SavAssocName "SPSS Dataset File"
#define SavAssocExt ".sav"
#define SavAssocKey StringChange(SavAssocName, " ", "") + SavAssocExt

#define ZsavAssocName "SPSS Dataset File"
#define ZsavAssocExt ".zsav"
#define ZsavAssocKey StringChange(ZsavAssocName, " ", "") + ZsavAssocExt

#define XptAssocName "SPSS Dataset File"
#define XptAssocExt ".xpt"
#define XptAssocKey StringChange(XptAssocName, " ", "") + XptAssocExt

#define PorAssocName "SPSS Dataset File"
#define PorAssocExt ".por"
#define PorAssocKey StringChange(PorAssocName, " ", "") + PorAssocExt

#define DtaAssocName "STATA Dataset File"
#define DtaAssocExt ".dta"
#define DtaAssocKey StringChange(DtaAssocName, " ", "") + DtaAssocExt

#define SasAssocName "SAS Dataset File"
#define SasAssocExt ".sas7bdat"
#define SasAssocKey StringChange(SasAssocName, " ", "") + SasAssocExt

[Setup]
; NOTE: The value of AppId uniquely identifies this application. Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{D650DE0B-5D76-43E0-B9CF-91F8B9A429DF}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
;AppVerName={#MyAppName} {#MyAppVersion}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
DefaultDirName={autopf}\{#MyAppName}
ChangesAssociations=yes
DisableProgramGroupPage=yes
LicenseFile=@CMAKE_SOURCE_DIR@\Tools\windows\jaspLicense.rtf
;InfoAfterFile=JASP_INSTALL_DIR_NATIVE@\release_note.txt
; Uncomment the following line to run in non administrative install mode (install for current user only.)
;PrivilegesRequired=lowest
PrivilegesRequiredOverridesAllowed=dialog
OutputDir=@JASP_BINARY_DIR_NATIVE@\JASP\JASPEXE
OutputBaseFilename=JASP_{#MyAppVersion}_Setup
SetupIconFile=@CMAKE_SOURCE_DIR@\Tools\windows\exe\Assets\jasp_pak.ico
Compression=lzma
SolidCompression=yes
WizardStyle=modern
WizardImageStretch=yes
WizardSmallImageFile=@CMAKE_SOURCE_DIR@\Tools\windows\exe\Assets\jasp_logo.bmp,@CMAKE_SOURCE_DIR@\Tools\windows\exe\Assets\jasp_logo_64x68.bmp
WizardImageFile=@CMAKE_SOURCE_DIR@\Tools\windows\exe\Assets\jasp_wave_banner.bmp

[Languages]
Name: "english";            MessagesFile: "compiler:Default.isl"
Name: "armenian";           MessagesFile: "compiler:Languages\Armenian.isl"
Name: "brazilianportuguese"; MessagesFile: "compiler:Languages\BrazilianPortuguese.isl"
Name: "bulgarian";          MessagesFile: "compiler:Languages\Bulgarian.isl"
Name: "catalan";            MessagesFile: "compiler:Languages\Catalan.isl"
Name: "corsican";           MessagesFile: "compiler:Languages\Corsican.isl"
Name: "czech";              MessagesFile: "compiler:Languages\Czech.isl"
Name: "danish";             MessagesFile: "compiler:Languages\Danish.isl"
Name: "dutch";              MessagesFile: "compiler:Languages\Dutch.isl"
Name: "finnish";            MessagesFile: "compiler:Languages\Finnish.isl"
Name: "french";             MessagesFile: "compiler:Languages\French.isl"
Name: "german";             MessagesFile: "compiler:Languages\German.isl"
Name: "hebrew";             MessagesFile: "compiler:Languages\Hebrew.isl"
Name: "hungarian";          MessagesFile: "compiler:Languages\Hungarian.isl"
Name: "icelandic";          MessagesFile: "compiler:Languages\Icelandic.isl"
Name: "italian";            MessagesFile: "compiler:Languages\Italian.isl"
Name: "japanese";           MessagesFile: "compiler:Languages\Japanese.isl"
Name: "korean";             MessagesFile: "compiler:Languages\Korean.isl"
Name: "norwegian";          MessagesFile: "compiler:Languages\Norwegian.isl"
Name: "polish";             MessagesFile: "compiler:Languages\Polish.isl"
Name: "portuguese";         MessagesFile: "compiler:Languages\Portuguese.isl"
Name: "russian";            MessagesFile: "compiler:Languages\Russian.isl"
Name: "slovak";             MessagesFile: "compiler:Languages\Slovak.isl"
Name: "slovenian";          MessagesFile: "compiler:Languages\Slovenian.isl"
Name: "spanish";            MessagesFile: "compiler:Languages\Spanish.isl"
Name: "turkish";            MessagesFile: "compiler:Languages\Turkish.isl"
Name: "ukrainian";          MessagesFile: "compiler:Languages\Ukrainian.isl"
;Extra language files
Name: "zh";                 MessagesFile: "compiler:Languages\ChineseSimplified.isl"
Name: "zhTW";               MessagesFile: "compiler:Languages\ChineseTraditional.isl"

[Tasks]
Name: "desktopicon"; Description: "{cm:CreateDesktopIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked

[Files]
Source: "@JASP_INSTALL_DIR_NATIVE@\{#MyAppExeName}";        DestDir: "{app}";      Flags: ignoreversion
Source: "@JASP_INSTALL_DIR_NATIVE@\*";                      DestDir: "{app}";      Flags: ignoreversion recursesubdirs
; NOTE: Don't use "Flags: ignoreversion" on any shared system files

[Registry]
; associate .jasp
Root: HKA; Subkey: "Software\Classes\{#MyAppAssocExt}\OpenWithProgids";          ValueType: string; ValueName: "{#MyAppAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#MyAppAssocKey}";                          ValueType: string; ValueName: ""; ValueData: "{#MyAppAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#MyAppAssocKey}\DefaultIcon";              ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#MyAppAssocKey}\shell\open\command";       ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".jasp"; ValueData: ""
; associate .csv
Root: HKA; Subkey: "Software\Classes\{#CsvAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#CsvAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#CsvAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#CsvAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#CsvAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#CsvAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".csv"; ValueData: ""
; associate .ods
Root: HKA; Subkey: "Software\Classes\{#OdsAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#OdsAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#OdsAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#OdsAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#OdsAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#OdsAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".ods"; ValueData: ""
; associate .xls
Root: HKA; Subkey: "Software\Classes\{#XlsAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#XlsAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#XlsAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#XlsAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#XlsAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#XlsAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".xls"; ValueData: ""
; associate .xlsx
Root: HKA; Subkey: "Software\Classes\{#XlsxAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#XlsxAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#XlsxAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#XlsxAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#XlsxAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#XlsxAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".xlsx"; ValueData: ""
; associate .sav
Root: HKA; Subkey: "Software\Classes\{#SavAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#SavAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#SavAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#SavAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#SavAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#SavAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".sav"; ValueData: ""
; associate .zsav
Root: HKA; Subkey: "Software\Classes\{#ZsavAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#ZsavAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#ZsavAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#ZsavAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#ZsavAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#ZsavAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".zsav"; ValueData: ""
; associate .xpt
Root: HKA; Subkey: "Software\Classes\{#XptAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#XptAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#XptAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#XptAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#XptAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#XptAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".xpt"; ValueData: ""
; associate .por
Root: HKA; Subkey: "Software\Classes\{#PorAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#PorAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#PorAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#PorAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#PorAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#PorAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".por"; ValueData: ""
; associate .dta
Root: HKA; Subkey: "Software\Classes\{#DtaAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#DtaAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#DtaAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#DtaAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#DtaAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#DtaAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".dta"; ValueData: ""
; associate .sas7bdat
Root: HKA; Subkey: "Software\Classes\{#SasAssocExt}\OpenWithProgids";           ValueType: string; ValueName: "{#SasAssocKey}"; ValueData: ""; Flags: uninsdeletevalue
Root: HKA; Subkey: "Software\Classes\{#SasAssocKey}";                           ValueType: string; ValueName: ""; ValueData: "{#SasAssocName}"; Flags: uninsdeletekey
Root: HKA; Subkey: "Software\Classes\{#SasAssocKey}\DefaultIcon";               ValueType: string; ValueName: ""; ValueData: "{app}\icon.ico"
Root: HKA; Subkey: "Software\Classes\{#SasAssocKey}\shell\open\command";        ValueType: string; ValueName: ""; ValueData: """{app}\{#MyAppExeName}"" ""%1"""
Root: HKA; Subkey: "Software\Classes\Applications\{#MyAppExeName}\SupportedTypes"; ValueType: string; ValueName: ".sas7bdat"; ValueData: ""

;Start of Registry for Windows GameDVR
Root: HKA; Subkey: "Software\Microsoft\Windows\CurrentVersion\GameDVR"; Flags: uninsdeletekeyifempty;     Check: not IsAdminInstallMode
Root: HKA; Subkey: "Software\Microsoft\Windows\CurrentVersion\GameDVR"; ValueType: dword;      ValueName: "AppCaptureEnabled";     ValueData: $00000000; Flags: uninsdeletevalue; Check: not IsAdminInstallMode
Root: HKA; Subkey: "System\GameConfigStore";                            Flags: uninsdeletekeyifempty; Check: not IsAdminInstallMode
Root: HKA; Subkey: "System\GameConfigStore";                            ValueType: dword;       ValueName: "GameDVR_Enabled";       ValueData: $00000000; Flags: uninsdeletevalue; Check: not IsAdminInstallMode
Root: HKA; Subkey: "Software\Policies\Microsoft\Windows\GameDVR"; Flags: uninsdeletekeyifempty;  Check: IsAdminInstallMode
Root: HKA; Subkey: "Software\Policies\Microsoft\Windows\GameDVR"; ValueType: dword;            ValueName: "AllowGameDVR";       ValueData: $00000000; Flags: uninsdeletevalue; Check: IsAdminInstallMode
;End of Registry for Windows GameDVR

[Icons]
Name: "{autoprograms}\{#MyAppName}";    Filename: "{app}\{#MyAppExeName}"; IconFilename: "{app}\icon.ico"
Name: "{autodesktop}\{#MyAppName}";     Filename: "{app}\{#MyAppExeName}"; Tasks: desktopicon

[Run]
;When should we running the: Parameters: "--junctions";
Filename: "{app}\{#MyAppExeName}";  Description: "{cm:LaunchProgram,{#StringChange(MyAppName, '&', '&&')}}"; Flags: nowait postinstall skipifsilent
